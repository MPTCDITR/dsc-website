---
import Main from "@/components/Main.astro";
import DecreesList from "@/components/page/royal-decrees/DecressList.astro";
import TextElement from "@/components/TextElement";

import { POLICY_TYPES } from "@/content/content.type";
import { languages, type SupportedLanguage } from "@/i18n/ui";
import Layout from "@/layouts/Layout.astro";
import { getCollection } from "astro:content";

const title = "Sub Decrees";

export async function getStaticPaths() {
  return Object.keys(languages).map((lang) => ({
    params: { lang },
  }));
}

const lang = Astro.params.lang as SupportedLanguage;
const allDecrees = await getCollection("decrees");
const decrees = allDecrees.filter(
  (decree) =>
    decree.data.lang === lang && decree.data.type === POLICY_TYPES.SUB_DECREE,
);
---

<Layout title={title}>
  <Main>
    <section aria-label={title}>
      <header>
        <TextElement variant="heading" className="text-primary">
          {title}
        </TextElement>
      </header>
      <DecreesList decrees={decrees} lang={lang} />
    </section>
  </Main>
</Layout>
